<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- [추가] 네이버 검색엔진 소유 확인 -->
    <meta name="naver-site-verification" content="eb519328a14cc19cfd2ca61832ec3f46c0a315cc" />
    
    <!-- [추가] SEO 메타 태그 -->
    <meta name="description" content="{% if page_description %}{{ page_description }}{% else %}Fincore는 데이터 기반의 투자 시그널을 제공하여 감정에 휘둘리지 않는 객관적인 투자를 돕는 플랫폼입니다.{% endif %}">
    <meta property="og:title" content="{% if page_title %}{{ page_title }}{% else %}FINCORE | 데이터 기반 투자 시그널{% endif %}">
    <meta property="og:description" content="{% if page_description %}{{ page_description }}{% else %}Fincore는 데이터 기반의 투자 시그널을 제공하여 감정에 휘둘리지 않는 객관적인 투자를 돕는 플랫폼입니다.{% endif %}">
    <meta property="og:image" content="{{ url_for('static', filename='images/og_image.png', _external=True) }}">
    <meta property="og:url" content="{{ request.url }}">

    <title>{% if page_title %}{{ page_title }}{% else %}FINCORE | 데이터 기반 투자 시그널{% endif %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />

    <style>
        /* 스크롤바 공간 확보로 덜컹거림 방지 */
        html { overflow-y: scroll; }
        
        body { 
            font-family: 'Pretendard', sans-serif; 
            background-color: #f9fafb; /* 전체 배경: 아주 연한 회색 */
            color: #111;
        }

        /* [추가] 플래시 메시지 팝업 스타일 */
        .flash-popup-container {
            position: fixed;
            top: 80px; /* 헤더 높이(64px) + 여백 */
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
            width: 90%;
            max-width: 500px;
        }
        .flash-popup {
            padding: 12px 24px;
            border-radius: 9999px;
            font-size: 14px;
            font-weight: 600;
            color: white;
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            opacity: 0;
            transform: translateY(-20px);
            animation: fadeInDown 0.5s 0.1s forwards; /* 0.1초 딜레이 후 시작 */
        }
        .flash-popup.success { background-color: #2563eb; } /* 파란색 */
        .flash-popup.info { background-color: #4f46e5; } /* 남색 */
        .flash-popup.error { background-color: #dc2626; } /* 빨간색 */

        @keyframes fadeInDown {
            to { opacity: 1; transform: translateY(0); }
        }

        /* [추가] 아카이브 콘텐츠 내 테이블 반응형 스타일 */
        main table {
            display: block;
            max-width: 100%;
            overflow-x: auto;
            white-space: nowrap;
        }

    </style>
</head>
<body class="flex flex-col min-h-screen">

    <header class="bg-white border-b border-gray-200 sticky top-0 z-50 h-16">
        <div class="max-w-3xl mx-auto px-4 h-full flex items-center justify-between">
            
            <a href="/" class="flex items-center space-x-2 group shrink-0">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Logo" class="h-6 w-auto object-contain">
                <span class="text-xl font-black tracking-tight text-gray-900" style="font-family: 'Pretendard', sans-serif;">FINCORE</span>
            </a>

            <!-- [수정] 네비게이션을 헤더 밖으로 빼고, 공간을 채우기 위한 빈 div 추가 -->
            <div class="flex-1"></div>

            <div class="shrink-0 text-right">
                <a href="/#subscribe" class="inline-block bg-black text-white text-xs font-bold px-4 py-2 rounded-full hover:bg-gray-800 transition">
                    구독하기
                </a>
            </div>
        </div>
    </header>

    <!-- [추가] 플래시 메시지 팝업 렌더링 위치 -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="flash-popup-container" id="flash-container">
                {% for category, message in messages %}
                    <div class="flash-popup {{ category }}">
                        <i class="fa-solid {% if category == 'success' %}fa-check-circle{% elif category == 'info' %}fa-paper-plane{% else %}fa-circle-exclamation{% endif %} mr-2"></i>
                        {{ message }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <!-- [추가] 헤더 아래에 새로운 서브 네비게이션 메뉴 -->
    <nav class="w-full bg-white border-b border-gray-200 py-3">
        <div class="max-w-3xl mx-auto flex justify-center items-center space-x-2 px-4">
            <a href="/archive/signalist" class="px-4 py-2 rounded-full text-sm font-semibold transition-colors {% if 'signalist' in request.path %}bg-gray-900 text-white shadow-sm{% else %}text-gray-500 hover:bg-gray-100 hover:text-gray-900{% endif %}">The Signalist</a>
            <a href="/archive/moneybag" class="px-4 py-2 rounded-full text-sm font-semibold transition-colors {% if 'moneybag' in request.path or 'whalehunter' in request.path %}bg-gray-900 text-white shadow-sm{% else %}text-gray-500 hover:bg-gray-100 hover:text-gray-900{% endif %}">The Whale Hunter</a>
        </div>
    </nav>

    <main class="flex-grow w-full max-w-3xl mx-auto px-4 py-8">
        {% block content %}{% endblock %}
    </main>

    <footer class="bg-white border-t border-gray-200 mt-auto py-8">
        <div class="max-w-3xl mx-auto px-6 text-center">
            <p class="text-[10px] text-gray-400">&copy; 2025 Fincore. All rights reserved.</p>
        </div>
    </footer>

    <!-- [추가] 플래시 메시지 자동 숨김 스크립트 -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const flashContainer = document.getElementById('flash-container');
            if (flashContainer) {
                setTimeout(() => {
                    flashContainer.style.transition = 'opacity 0.5s ease-out';
                    flashContainer.style.opacity = '0';
                    setTimeout(() => flashContainer.remove(), 500);
                }, 4000); // 4초 후에 사라짐
            }
        });

        // [추가] 아카이브 페이지의 넓은 테이블에 스크롤 안내 문구 추가
        document.addEventListener('DOMContentLoaded', function() {
            const tables = document.querySelectorAll('main table');
            tables.forEach(table => {
                // 테이블이 부모 요소보다 넓어서 스크롤이 필요한 경우
                if (table.offsetWidth > table.parentElement.offsetWidth) {
                    const indicator = document.createElement('div');
                    indicator.innerHTML = '↔️ <span class="hidden sm:inline">좌우로 스크롤하여 더 많은 정보를 확인하세요.</span>';
                    indicator.className = 'text-xs text-gray-400 text-right mt-1 select-none';
                    
                    // 테이블 바로 다음에 안내 문구 삽입
                    table.parentNode.insertBefore(indicator, table.nextSibling);
                }
            });
        });
    </script>

</body>
</html>